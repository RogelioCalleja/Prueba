{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/ROGE-/ecomerce1/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ElementRef } from '@angular/core';\nimport { Producto } from \"../producto\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../productos.service\";\nimport * as i2 from \"@angular/material/snack-bar\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/material/button\";\nimport * as i5 from \"@angular/material/form-field\";\nimport * as i6 from \"@angular/material/input\";\nimport * as i7 from \"@angular/forms\";\nimport * as i8 from \"@angular/material/card\";\nimport * as i9 from \"../loading-button/loading-button.component\";\nconst _c0 = [\"foto\"];\nexport let AgregarProductoComponent = /*#__PURE__*/(() => {\n  class AgregarProductoComponent {\n    constructor(productosService, snackBar) {\n      this.productosService = productosService;\n      this.snackBar = snackBar;\n      this.productoModel = new Producto(\"\", \"\");\n      this.cargando = false;\n    }\n    guardar() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        if (!_this.productoModel.nombre) {\n          return alert(\"Escribe un nombre\");\n        }\n        if (!_this.productoModel.descripcion) {\n          return alert(\"Escribe la descripción\");\n        }\n        if (!_this.productoModel.precio) {\n          return alert(\"Escribe el precio\");\n        }\n        let archivos = _this.foto.nativeElement.files;\n        if (!archivos.length) {\n          return alert(\"Selecciona al menos una foto\");\n        }\n        _this.cargando = true;\n        // Guardamos producto\n        const idProductoGuardado = yield _this.productosService.agregarProducto(_this.productoModel);\n        // Y luego las fotos\n        const fd = new FormData();\n        for (let x = 0; x < archivos.length; x++) {\n          fd.append(`foto_${x}`, archivos[x]);\n        }\n        fd.append(\"idProducto\", idProductoGuardado);\n        const respuesta = yield _this.productosService.agregarFotosDeProducto(fd);\n        _this.snackBar.open(\"Producto guardado\", \"\", {\n          duration: 1500,\n          horizontalPosition: \"start\",\n          verticalPosition: \"top\"\n        });\n        _this.cargando = false;\n        _this.productoModel = new Producto(\"\", \"\");\n        _this.foto.nativeElement.value = \"\";\n      })();\n    }\n    ngOnInit() {}\n    static #_ = this.ɵfac = function AgregarProductoComponent_Factory(t) {\n      return new (t || AgregarProductoComponent)(i0.ɵɵdirectiveInject(i1.ProductosService), i0.ɵɵdirectiveInject(i2.MatSnackBar));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: AgregarProductoComponent,\n      selectors: [[\"app-agregar-producto\"]],\n      viewQuery: function AgregarProductoComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(_c0, 5, ElementRef);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.foto = _t.first);\n        }\n      },\n      decls: 21,\n      vars: 4,\n      consts: [[\"foto\", \"\"], [\"matInput\", \"\", \"type\", \"text\", \"placeholder\", \"Nombre\", 3, \"ngModelChange\", \"ngModel\"], [\"rows\", \"10\", \"matInput\", \"\", \"placeholder\", \"Descripci\\u00F3n\", 3, \"ngModelChange\", \"ngModel\"], [\"matInput\", \"\", \"type\", \"number\", \"placeholder\", \"Precio\", 3, \"ngModelChange\", \"ngModel\"], [\"for\", \"fotos\"], [\"accept\", \"image/png,image/jpeg\", \"required\", \"\", \"id\", \"fotos\", \"multiple\", \"\", \"type\", \"file\"], [\"texto\", \"Guardar\", 3, \"click\", \"cargando\"], [\"routerLink\", \"/productos\", \"mat-raised-button\", \"\", \"color\", \"primary\", 2, \"margin-left\", \"10px\"]],\n      template: function AgregarProductoComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"mat-card\")(1, \"h1\");\n          i0.ɵɵtext(2, \"Agregar producto\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"p\")(4, \"mat-form-field\")(5, \"input\", 1);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function AgregarProductoComponent_Template_input_ngModelChange_5_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            i0.ɵɵtwoWayBindingSet(ctx.productoModel.nombre, $event) || (ctx.productoModel.nombre = $event);\n            return i0.ɵɵresetView($event);\n          });\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(6, \"p\")(7, \"mat-form-field\")(8, \"textarea\", 2);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function AgregarProductoComponent_Template_textarea_ngModelChange_8_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            i0.ɵɵtwoWayBindingSet(ctx.productoModel.descripcion, $event) || (ctx.productoModel.descripcion = $event);\n            return i0.ɵɵresetView($event);\n          });\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(9, \"p\")(10, \"mat-form-field\")(11, \"input\", 3);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function AgregarProductoComponent_Template_input_ngModelChange_11_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            i0.ɵɵtwoWayBindingSet(ctx.productoModel.precio, $event) || (ctx.productoModel.precio = $event);\n            return i0.ɵɵresetView($event);\n          });\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(12, \"label\", 4);\n          i0.ɵɵtext(13, \"Fotos\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(14, \"br\")(15, \"input\", 5, 0);\n          i0.ɵɵelementStart(17, \"p\")(18, \"app-loading-button\", 6);\n          i0.ɵɵlistener(\"click\", function AgregarProductoComponent_Template_app_loading_button_click_18_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.guardar());\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(19, \"a\", 7);\n          i0.ɵɵtext(20, \"Volver\");\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(5);\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.productoModel.nombre);\n          i0.ɵɵadvance(3);\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.productoModel.descripcion);\n          i0.ɵɵadvance(3);\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.productoModel.precio);\n          i0.ɵɵadvance(7);\n          i0.ɵɵproperty(\"cargando\", ctx.cargando);\n        }\n      },\n      dependencies: [i3.RouterLink, i4.MatAnchor, i5.MatFormField, i6.MatInput, i7.DefaultValueAccessor, i7.NumberValueAccessor, i7.NgControlStatus, i7.NgModel, i8.MatCard, i9.LoadingButtonComponent],\n      styles: [\"input[type=file][_ngcontent-%COMP%]{margin:10px 0}\"]\n    });\n  }\n  return AgregarProductoComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}